<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yeonghoon Yoo" />


<title>Introduction to bartcs</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to bartcs</h1>
<h4 class="author">Yeonghoon Yoo</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(bartcs)</span></code></pre></div>
<p>The <strong>bartcs</strong> package finds confounders and treatment
effect with Bayesian Additive Regression Trees (BART).</p>
<div id="tutorial-with-ihdp-dataset" class="section level2">
<h2>Tutorial with IHDP dataset</h2>
<p>This tutorial will use The Infant Health and Development Program
(IHDP) dataset. IHDP is a randomized experiment from 1985 to 1988 which
studied the effect of home visits on cognitive test scores for infants.
Our version is a synthetic dataset generated by <span class="citation">Louizos et al. (<a href="#ref-louizos:2017">2017</a>)</span> which provides true values to
compare with. The dataset consists of 6 continuous and 19 binary
covariates with simulated outcome which is a cognitive test score.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(ihdp, <span class="at">package =</span> <span class="st">&quot;bartcs&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">single_bart</span>(</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">Y               =</span> ihdp<span class="sc">$</span>y_factual,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">trt             =</span> ihdp<span class="sc">$</span>treatment,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">X               =</span> ihdp[, <span class="dv">6</span><span class="sc">:</span><span class="dv">30</span>],</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">num_tree        =</span> <span class="dv">10</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">num_chain       =</span> <span class="dv">4</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">num_post_sample =</span> <span class="dv">100</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">num_burn_in     =</span> <span class="dv">100</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">verbose         =</span> <span class="cn">FALSE</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; Warning in .recacheSubclasses(def@className, def, env): undefined subclass</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; &quot;ndiMatrix&quot; of class &quot;replValueSp&quot;; definition not updated</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>fit</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; `bartcs` fit by `single_bart()`</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;         mean     2.5%    97.5%</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; ATE 3.989180 3.757940 4.194852</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; Y1  6.414511 6.209326 6.594922</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; Y0  2.425331 2.352195 2.512516</span></span></code></pre></div>
<p>You can get mean and 95% credible interval of average treatment
effect (ATE) and possible outcome Y1 and Y0.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ATE <span class="ot">&lt;-</span> <span class="fu">mean</span>(ihdp<span class="sc">$</span>mu1 <span class="sc">-</span> ihdp<span class="sc">$</span>mu0)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ATE</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; [1] 4.016067</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(ihdp<span class="sc">$</span>mu1)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>mu1</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; [1] 6.44858</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(ihdp<span class="sc">$</span>mu0)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>mu0</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; [1] 2.432513</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">unlist</span>(fit<span class="sc">$</span>mcmc_list[, <span class="st">&quot;ATE&quot;</span>]) <span class="sc">-</span> ATE)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>mse</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.01311197</span></span></code></pre></div>
<p>True values of ATE, mu1 and mu0 all lies in 95% credible interval.
Also, MSE between predicted and true values is 0.013.</p>
</div>
<div id="result" class="section level2">
<h2>Result</h2>
<p>Both <code>separate_bart()</code> and <code>single_bart()</code> fits
multiple MCMC chains. <code>summary()</code> provides result for each
and aggregated chain.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; `bartcs` fit by `single_bart()`</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Treatment Value</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;   Treated group    :      1</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;   Control group    :      0</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; Tree Parameters</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;   Number of Tree   :     10      Value  of alpha    :   0.95</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;   Prob.  of Grow   :   0.28      Value  of beta     :      2</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;   Prob.  of Prune  :   0.28      Value  of nu       :      3</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;   Prob.  of Change :   0.44      Value  of q        :   0.95</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Chain Parameters</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;   Number of Chains :      4      Number of burn-in  :    100</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt;   Number of Iter   :    200      Number of thinning :      1</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt;   Number of Sample :    100</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; Outcome </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;  estimand chain     2.5%       1Q     mean   median       3Q    97.5%</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;       ATE     1 3.773543 3.911107 3.972227 3.970111 4.056683 4.151239</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;       ATE     2 3.772706 3.941568 3.999966 4.008911 4.055016 4.193598</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;       ATE     3 3.741889 3.859122 3.943162 3.959975 4.021592 4.118731</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt;       ATE     4 3.819920 3.971550 4.041364 4.045832 4.111067 4.252098</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;       ATE   agg 3.757940 3.914043 3.989180 3.990748 4.061248 4.194852</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt;        Y1     1 6.215452 6.328724 6.396984 6.404919 6.460931 6.543268</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt;        Y1     2 6.261225 6.359134 6.426559 6.434194 6.486718 6.590550</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt;        Y1     3 6.184771 6.320276 6.377308 6.382648 6.450492 6.545511</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt;        Y1     4 6.245013 6.393345 6.457192 6.465348 6.513756 6.672324</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt;        Y1   agg 6.209326 6.347214 6.414511 6.423418 6.480329 6.594922</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt;        Y0     1 2.342513 2.399295 2.424757 2.423876 2.451448 2.506433</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt;        Y0     2 2.355629 2.398670 2.426593 2.426521 2.448976 2.495499</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt;        Y0     3 2.357711 2.401557 2.434146 2.431961 2.460607 2.517344</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt;        Y0     4 2.346422 2.389331 2.415827 2.412804 2.441819 2.511036</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt;        Y0   agg 2.352195 2.397022 2.425331 2.424030 2.450444 2.512516</span></span></code></pre></div>
</div>
<div id="data-visualization" class="section level2">
<h2>Data Visualization</h2>
<p>You can get posterior inclusion probability for each variables.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">method =</span> <span class="st">&quot;pip&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Since <code>inclusion_plot()</code> is a wrapper function of
<code>ggcharts::bar_chart()</code>, you can use its arguments for better
plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">method =</span> <span class="st">&quot;pip&quot;</span>, <span class="at">top_n =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">method =</span> <span class="st">&quot;pip&quot;</span>, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With <code>trace_plot()</code>, you can visually check trace of
effects or other parameters.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">method =</span> <span class="st">&quot;trace&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="connection-to-coda-package" class="section level2">
<h2>Connection to coda Package</h2>
<p>You can also use functions from <code>coda</code> package for
components of <code>bartcs</code> object. Components with
<code>mcmc_</code> prefix are <code>mcmc.list</code> object from
<code>coda</code> package.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">gelman.diag</span>(fit<span class="sc">$</span>mcmc_list[, <span class="st">&quot;ATE&quot;</span>])</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;      Point est. Upper C.I.</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [1,]        1.1       1.28</span></span></code></pre></div>
</div>
<div id="multi-threading" class="section level2">
<h2>Multi-threading</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">count_omp_thread</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>Check whether OpenMP is supported. You need more than 1 thread for
multi-threading. Due to overhead of multi-threading, using
parallelization will <strong>NOT</strong> be effective with small and
moderate size datasets.</p>
<p>For comparison purpose, I will create dataset with 40,000 rows by
bootstrapping from IHDP dataset. Then, for fast computation, I will fit
the model with most parameters set to 1.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>idx  <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(ihdp), <span class="fl">4e4</span>, <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>ihdp <span class="ot">&lt;-</span> ihdp[idx, ]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">simple =</span> <span class="fu">single_bart</span>(</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">Y               =</span> ihdp<span class="sc">$</span>y_factual,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">trt             =</span> ihdp<span class="sc">$</span>treatment,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">X               =</span> ihdp[, <span class="dv">6</span><span class="sc">:</span><span class="dv">30</span>],</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">num_tree        =</span> <span class="dv">1</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="at">num_chain       =</span> <span class="dv">1</span>,</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">num_post_sample =</span> <span class="dv">10</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">num_burn_in     =</span> <span class="dv">0</span>,</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="at">verbose         =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    <span class="at">parallel        =</span> <span class="cn">FALSE</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  ),</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="at">parallel =</span> <span class="fu">single_bart</span>(</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    <span class="at">Y               =</span> ihdp<span class="sc">$</span>y_factual,</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="at">trt             =</span> ihdp<span class="sc">$</span>treatment,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="at">X               =</span> ihdp[, <span class="dv">6</span><span class="sc">:</span><span class="dv">30</span>],</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>    <span class="at">num_tree        =</span> <span class="dv">1</span>,</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>    <span class="at">num_chain       =</span> <span class="dv">1</span>,</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>    <span class="at">num_post_sample =</span> <span class="dv">10</span>,</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    <span class="at">num_burn_in     =</span> <span class="dv">0</span>,</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>    <span class="at">verbose         =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>    <span class="at">parallel        =</span> <span class="cn">TRUE</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>  ),</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">50</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>)</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt;      expr      min       lq     mean   median       uq      max neval</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt;    simple 118.3031 140.6865 148.3293 148.1015 155.3117 187.7820    50</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;  parallel 105.1264 119.1141 128.3335 123.4629 128.8308 238.4459    50</span></span></code></pre></div>
<p>Result show that parallelization reduces computation time.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-louizos:2017" class="csl-entry">
Louizos, Christos, Uri Shalit, Joris M Mooij, David Sontag, Richard
Zemel, and Max Welling. 2017. <span>“Causal Effect Inference with Deep
Latent-Variable Models.”</span> <em>Advances in Neural Information
Processing Systems</em> 30. <a href="https://doi.org/10.48550/arXiv.1705.08821">https://doi.org/10.48550/arXiv.1705.08821</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
